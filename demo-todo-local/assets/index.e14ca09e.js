var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var k=(t,e,r)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,R=(t,e)=>{for(var r in e||(e={}))re.call(e,r)&&k(t,r,e[r]);if(V)for(var r of V(e))se.call(e,r)&&k(t,r,e[r]);return t},A=(t,e)=>ee(t,te(e));var u=(t,e,r)=>(k(t,typeof e!="symbol"?e+"":e,r),r);import{n as ne,i as I,h as oe,t as C,a as ie,r as N,g as j,e as M,K as ue,c as ae,b as y,o as ce,d as $,f as h,w as D,v as de,j as v,k as x,l as _,m as le,p as f,F as b,q as fe,s as pe,u as he,x as me,y as ye,z as F,A as ve}from"./vendor.0c0e7aab.js";const be=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};be();const c={rpcProvider(){throw new Error("must install with rpcProvider before query or call")}},O=new Map;function we(t,e){m.provide(t),Object.assign(c,e),t.mixin({created(){if(c.dehydrate||c.hydrate){const s=this.$.render;this.$.render=function(...o){let i=s.apply(this,o);if((!I(i)||typeof i.type!="string")&&(i=oe("div",i)),c.hydrate)return i;i.props||(i.props={});const a={};for(const[g,l]of Object.entries(C(this.$.data)))ie(l)&&l.value&&l.value.data&&(a[g]=l.value.data);return i.props["data-dehydrated"]=JSON.stringify(a),i}}const r=this.$.type;let n=r.instanceCount;n||(n=r.instanceCount=N(0)),n.value++},beforeMount(){var s;if(!c.hydrate)return;const r=(s=this.$el.dataset)==null?void 0:s.dehydrated;if(!r)return;const n=C(this.$.data);for(const[o,i]of Object.entries(JSON.parse(r)))n[o].value={loading:!1,data:i}},async serverPrefetch(){await m.inject().flushing}})}function $e(t,e){M(()=>{const r=e();for(const[n,s]of Object.entries(r))if(typeof s=="object")for(const[o,i]of Object.entries(s))t[n][o]=i;else t[n]=s})}function J(t){return K(t.$).proxy}function K(t){return!t.parent||t.parent.type===ue?t:K(t.parent)}function L(t,e){if(t instanceof d){const r=W(t,e);return ae(()=>{const n=r.value;return{loading:n.loading,data:n.data[0],error:n.error}})}return S(t,e)[0]}function S(t,e){if(t instanceof d)return W(t,e);const r=t;r.instanceCount||(r.instanceCount=N(0)),r.instanceCount.value;const n=[];let s;if(e.$parent)s=e.$parent.$.subTree;else if(e.$root)s=e.$root.$.subTree,delete e.$root;else throw new Error("must provide $parent or $root");return T(n,s,r,e),n}function T(t,e,r,n){if(!!e){if(e.component)e.type===r&&ge(e.component.proxy,n)&&t.push(e.component.proxy),T(t,e.component.subTree,r,n);else if(Array.isArray(e.children))for(const s of e.children)I(s)&&T(t,s,r,n)}}function ge(t,e){if(!e)return!0;for(const[r,n]of Object.entries(e))if(r==="$parent"){if(t.$.parent.proxy!==n)return!1}else if(t[r]!==n)return!1;return!0}function ke(t,e,...r){const n=t.$;Q(!0,e,r,n)}function B(t,e,r){if(r.component)Q(!1,t,e,r.component);else if(Array.isArray(r.children))for(const n of r.children)I(n)&&B(t,e,n)}function Q(t,e,r,n){const s=n.proxy;!t&&s[e]?s[e].apply(s,r):B(e,r,n.subTree)}function w(){return new Promise(t=>{ne(t)})}async function Re(t){return new Promise(e=>setTimeout(e,t))}function z(t,e){if(e instanceof d)return t;if(t.$.type!==e)throw new Error("type mismatch");return t}function U(t){let e=this&&this.Resource!==d?this:void 0;return{as(r){const n=s=>{const o=[];for(const g of t.affectedTables){const l=O.get(g);for(const Y of l||[])o.push(Y.newRequest())}const i=t.command||r,a=new H(i,s);return c.rpcProvider(o,a),a.promise};return A(R({},e),{[r]:n,defineCommand:U})}}}function qe(t,e){return y(new d(t,e))}const p=class{constructor(){u(this,"buffered",[]);u(this,"flushing")}static provide(e){e.provide(p.key,new p)}static inject(){return j().appContext.provides[p.key]}execute(e){this.buffered.push(e),this.buffered.length===1&&(this.flushing=this.flush())}async flush(){await w();const e=this.buffered.map(r=>r.newRequest());this.buffered=[],await c.rpcProvider(e),this.flushing=void 0}};let m=p;u(m,"key",Symbol());class Ce{constructor(e,r){u(this,"result",N({loading:!1,data:[],error:void 0}));u(this,"criteria",{});u(this,"version",0);this.resource=e;const n=m.inject(),s=j();M(()=>{r&&(this.criteria=r()),c.hydrate&&!s.isMounted||n.execute(this)})}newRequest(){return this.version++,new G(this)}}class d{constructor(e,r){u(this,"pickedFields");u(this,"subResources",{});this.table=e,this.options=r}clone(){const e=new d(this.table,this.options);return e.pickedFields=this.pickedFields,e.subResources=R({},this.subResources),e}pick(...e){const r=this.clone();return r.pickedFields=e,y(r)}load(e,r,n,s){const o=this.clone();return o.subResources[e]={single:!0,resource:r,dynamicCriteria:n,staticCriteria:s==null?void 0:s.staticCriteria},y(o)}query(e,r,n,s){const o=this.clone();return o.subResources[e]={resource:r,dynamicCriteria:n,staticCriteria:s==null?void 0:s.staticCriteria},y(o)}toJSON(){var e;return{table:this.table,staticCriteria:(e=this.options)==null?void 0:e.staticCriteria,subResources:Object.keys(this.subResources).length===0?void 0:this.subResources}}}function W(t,e){const r=new Ce(C(t),e);return j().scope.run(()=>{let n=O.get(t.table);n||O.set(t.table,n=new Set),n.add(r),ce(()=>{n.delete(r)})}),r.result}class G{constructor(e){u(this,"baseVersion");u(this,"criteria");this.query=e,this.baseVersion=e.version,this.criteria=e.criteria}get resource(){return this.query.resource}get isExpired(){return this.baseVersion!==this.query.version}resolve(e){this.isExpired||(this.query.version++,this.query.result.value={loading:!1,data:e,error:void 0})}reject(e){this.isExpired||(this.query.version++,this.query.result.value={loading:!1,data:[],error:e})}toJSON(){return{resource:this.resource,criteria:this.criteria}}}class H{constructor(e,r){u(this,"promise");u(this,"resolve");u(this,"reject");u(this,"responded",!1);this.command=e,this.args=r,this.promise=new Promise((n,s)=>{this.resolve=o=>{this.responded||(this.responded=!0,n(o))},this.reject=o=>{this.responded||(this.responded=!0,s(o))}})}toJSON(){return{command:this.command,args:this.args}}}var _e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",install:we,animate:$e,pageOf:J,load:L,query:S,walk:ke,waitNextTick:w,sleep:Re,castTo:z,defineCommand:U,defineResource:qe,Resource:d,QueryRequest:G,CommandRequest:H}),E=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r};const Oe=$({props:{itemId:{type:String,required:!0}},data(){return{visible:!1,content:"",completed:!1}},methods:{init(t){this.visible=!0,this.content=t},onRemove(){z(this.$parent,P).remove(this.itemId)}}}),Te={key:0};function Ie(t,e,r,n,s,o){return t.visible?(f(),h("div",Te,[D(v("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=i=>t.completed=i)},null,512),[[de,t.completed]]),x(" "+_(t.content)+" ",1),v("button",{onClick:e[1]||(e[1]=(...i)=>t.onRemove&&t.onRemove(...i))},"x")])):le("",!0)}var q=E(Oe,[["render",Ie]]);const Ne=$({components:{TodoListItem:q},data(){return{itemIds:[]}},computed:{completedCount(){let t=0;for(const e of S(q,{$parent:this}))e.completed&&t++;return t}},methods:{async add(){const t=`${new Date().getTime()}`;return this.itemIds.push(t),await w(),L(q,{$parent:this,itemId:t})},async remove(t){const e=this.itemIds.indexOf(t);e!==-1&&(this.itemIds.splice(e,1),await w())}}});function je(t,e,r,n,s,o){const i=pe("TodoListItem");return f(),h(b,null,[x(_(t.completedCount)+" out of "+_(t.itemIds.length)+" items completed ",1),(f(!0),h(b,null,fe(t.itemIds,a=>(f(),he(i,{key:a,itemId:a},null,8,["itemId"]))),128))],64)}var P=E(Ne,[["render",je]]);const xe=$({data(){return{content:""}},methods:{async onEnter(){if(!this.content)return;(await L(P,{$root:J(this)}).add()).init(this.content),this.content=""}}}),Le=x(" What needs to be done? ");function Se(t,e,r,n,s,o){return f(),h(b,null,[Le,D(v("input",{type:"textbox","onUpdate:modelValue":e[0]||(e[0]=i=>t.content=i),onKeyup:e[1]||(e[1]=ye((...i)=>t.onEnter&&t.onEnter(...i),["enter"]))},null,544),[[me,t.content]])],64)}var Ee=E(xe,[["render",Se]]);const Pe=v("h1",null,"To-Do List",-1),Ve=$({setup(t){return(e,r)=>(f(),h(b,null,[Pe,F(Ee),F(P)],64))}}),X=ve(Ve);X.use(_e);X.mount("#app");
