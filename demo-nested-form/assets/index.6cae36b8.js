var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var q=(t,e,n)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k=(t,e)=>{for(var n in e||(e={}))ne.call(e,n)&&q(t,n,e[n]);if(L)for(var n of L(e))re.call(e,n)&&q(t,n,e[n]);return t},P=(t,e)=>ee(t,te(e));var a=(t,e,n)=>(q(t,typeof e!="symbol"?e+"":e,n),n);import{i as x,h as se,t as R,a as oe,r as N,g as A,e as E,K as ie,c as ae,n as ue,b,o as ce,d as g,f as h,j as l,k as _,w as M,v as le,F as S,l as f,m as de,p as fe,q as m,s as C,u as pe,x as he,y as me}from"./vendor.b524b93f.js";const ve=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};ve();const u={rpcProvider(){throw new Error("must install with rpcProvider before query or call")}},F=new Map;function ye(t,e){y.provide(t),Object.assign(u,e),t.mixin({created(){if(u.dehydrate||u.hydrate){const r=this.$.render;this.$.render=function(...o){let i=r.apply(this,o);if((!x(i)||typeof i.type!="string")&&(i=se("div",i)),u.hydrate)return i;i.props||(i.props={});const c={};for(const[$,p]of Object.entries(R(this.$.data)))oe(p)&&p.value&&p.value.data&&(c[$]=p.value.data);return i.props["data-dehydrated"]=JSON.stringify(c),i}}const n=this.$.type;let s=n.instanceCount;s||(s=n.instanceCount=N(0)),s.value++},beforeMount(){var r;if(!u.hydrate)return;const n=(r=this.$el.dataset)==null?void 0:r.dehydrated;if(!n)return;const s=R(this.$.data);for(const[o,i]of Object.entries(JSON.parse(n)))s[o].value={loading:!1,data:i}},async serverPrefetch(){await y.inject().flushing}})}function ge(t,e){E(()=>{const n=e();for(const[s,r]of Object.entries(n))if(typeof r=="object")for(const[o,i]of Object.entries(r))t[s][o]=i;else t[s]=r})}function be(t){return V(t.$).proxy}function V(t){return!t.parent||t.parent.type===ie?t:V(t.parent)}function I(t,e){if(t instanceof d){const n=z(t,e);return ae(()=>{const s=n.value;return{loading:s.loading,data:s.data[0],error:s.error}})}return D(t,e)[0]}function D(t,e){if(t instanceof d)return z(t,e);const n=t;n.instanceCount||(n.instanceCount=N(0)),n.instanceCount.value;const s=[];let r;if(e.$parent)r=e.$parent.$.subTree;else if(e.$root)r=e.$root.$.subTree,delete e.$root;else throw new Error("must provide $parent or $root");return j(s,r,n,e),s}function j(t,e,n,s){if(!!e){if(e.component)e.type===n&&_e(e.component.proxy,s)&&t.push(e.component.proxy),j(t,e.component.subTree,n,s);else if(Array.isArray(e.children))for(const r of e.children)x(r)&&j(t,r,n,s)}}function _e(t,e){if(!e)return!0;for(const[n,s]of Object.entries(e))if(n==="$parent"){if(t.$.parent.proxy!==s)return!1}else if(t[n]!==s)return!1;return!0}function J(t,e,...n){const s=t.$;K(!0,e,n,s)}function B(t,e,n){if(n.component)K(!1,t,e,n.component);else if(Array.isArray(n.children))for(const s of n.children)x(s)&&B(t,e,s)}function K(t,e,n,s){const r=s.proxy;!t&&r[e]?r[e].apply(r,n):B(e,n,s.subTree)}function Q(){return new Promise(t=>{ue(t)})}async function O(t){return new Promise(e=>setTimeout(e,t))}function we(t,e){if(e instanceof d)return t;if(t.$.type!==e)throw new Error("type mismatch");return t}function U(t){let e=this&&this.Resource!==d?this:void 0;return{as(n){const s=r=>{const o=[];for(const $ of t.affectedTables){const p=F.get($);for(const Y of p||[])o.push(Y.newRequest())}const i=t.command||n,c=new H(i,r);return u.rpcProvider(o,c),c.promise};return P(k({},e),{[n]:s,defineCommand:U})}}}function $e(t,e){return b(new d(t,e))}const v=class{constructor(){a(this,"buffered",[]);a(this,"flushing")}static provide(e){e.provide(v.key,new v)}static inject(){return A().appContext.provides[v.key]}execute(e){this.buffered.push(e),this.buffered.length===1&&(this.flushing=this.flush())}async flush(){await Q();const e=this.buffered;this.buffered=[],await u.rpcProvider(e),this.flushing=void 0}};let y=v;a(y,"key",Symbol());class qe{constructor(e,n){a(this,"result",N({loading:!1,data:[],error:void 0}));a(this,"criteria",{});a(this,"version",0);this.resource=e;const s=y.inject(),r=A();E(()=>{n&&(this.criteria=n()),u.hydrate&&!r.isMounted||s.execute(this.newRequest(!r.isMounted))})}newRequest(e){return this.version++,new G(this,!!e)}}class d{constructor(e,n){a(this,"pickedFields");a(this,"subResources",{});this.table=e,this.options=n}clone(){const e=new d(this.table,this.options);return e.pickedFields=this.pickedFields,e.subResources=k({},this.subResources),e}pick(...e){const n=this.clone();return n.pickedFields=e,b(n)}load(e,n,s,r){const o=this.clone();return o.subResources[e]={single:!0,resource:n,dynamicCriteria:s,staticCriteria:r==null?void 0:r.staticCriteria},b(o)}query(e,n,s,r){const o=this.clone();return o.subResources[e]={resource:n,dynamicCriteria:s,staticCriteria:r==null?void 0:r.staticCriteria},b(o)}toJSON(){var e;return{table:this.table,staticCriteria:(e=this.options)==null?void 0:e.staticCriteria,subResources:Object.keys(this.subResources).length===0?void 0:this.subResources}}}function z(t,e){const n=new qe(R(t),e);return A().scope.run(()=>{let s=F.get(t.table);s||F.set(t.table,s=new Set),s.add(n),ce(()=>{s.delete(n)})}),n.result}class G{constructor(e,n){a(this,"baseVersion");a(this,"criteria");a(this,"showingLoading");this.query=e,this.showLoading=n,this.baseVersion=e.version,this.criteria=e.criteria,n&&(u.loadingPreDelay?O(u.loadingPreDelay||0).then(()=>{this.showingLoading=this.loadingCountdown()}):this.showingLoading=this.loadingCountdown())}async loadingCountdown(){this.isExpired||(this.query.result.value={loading:!0,data:[],error:void 0},await O(u.loadingPostDelay||0))}get resource(){return this.query.resource}get isExpired(){return this.baseVersion!==this.query.version}resolve(e){if(!this.isExpired){if(this.showingLoading){this.showingLoading.then(()=>{this.showingLoading=void 0,this.resolve(e)});return}this.query.version++,this.query.result.value={loading:!1,data:e,error:void 0}}}reject(e){if(!this.isExpired){if(this.showingLoading){this.showingLoading.then(()=>{this.showingLoading=void 0,this.reject(e)});return}this.query.version++,this.query.result.value={loading:!1,data:[],error:e}}}toJSON(){return{resource:this.resource,criteria:this.criteria}}}class H{constructor(e,n){a(this,"promise");a(this,"resolve");a(this,"reject");a(this,"responded",!1);this.command=e,this.args=n,this.promise=new Promise((s,r)=>{this.resolve=o=>{this.responded||(this.responded=!0,s(o))},this.reject=o=>{this.responded||(this.responded=!0,r(o))}})}toJSON(){return{command:this.command,args:this.args}}}var ke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",install:ye,animate:ge,pageOf:be,load:I,query:D,walk:J,waitNextTick:Q,sleep:O,castTo:we,defineCommand:U,defineResource:$e,Resource:d,QueryRequest:G,CommandRequest:H});function W(t){const e={};return J(t,"fillForm",e),e}var w=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n};const Re=g({props:{label:{default:""},name:{type:String,required:!0}},data(){return{value:""}},methods:{fillForm(t){t[this.name]=this.value}}}),Se=["name"];function Ce(t,e,n,s,r,o){return f(),h(S,null,[l("label",null,_(t.label),1),M(l("input",{type:"textbox",name:t.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i)},null,8,Se),[[le,t.value]])],64)}var Fe=w(Re,[["render",Ce]]);const je=g({props:{label:{default:""},name:{required:!0,type:String},options:{default:[]}},data(){return{selected:""}},methods:{fillForm(t){t[this.name]=this.selected}}}),Oe=l("option",{value:""},"Please select...",-1),xe=["value"];function Ne(t,e,n,s,r,o){return f(),h(S,null,[l("label",null,_(t.label),1),M(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.selected=i)},[Oe,(f(!0),h(S,null,fe(t.options,i=>(f(),h("option",{value:i.id},_(i.name),9,xe))),256))],512),[[de,t.selected]])],64)}var T=w(je,[["render",Ne]]);const Ae=g({components:{SelectField:T,InputField:Fe},props:{name:{required:!0,type:String},legend:{default:"Address"}},data(){return{provinces:[{id:"jiangxi",name:"jiangxi"},{id:"hubei",name:"hubei"}]}},computed:{cities(){var n;const t=(n=I(T,{$parent:this,name:"province"}))==null?void 0:n.selected;return{jiangxi:[{id:"nanchang",name:"nanchange"},{id:"jiujiang",name:"jiujiang"}],hubei:[{id:"wuhan",name:"wuhan"},{id:"huangshi",name:"huangshi"}]}[t]||[]}},methods:{fillForm(t){t[this.name]=W(this)}}}),Le={class:"fields"};function Pe(t,e,n,s,r,o){const i=C("SelectField"),c=C("InputField");return f(),h("fieldset",null,[l("legend",null,_(t.legend),1),l("div",Le,[m(i,{label:"province:",name:"province",options:t.provinces},null,8,["options"]),m(i,{label:"city:",name:"city",options:t.cities},null,8,["options"]),m(c,{label:"street:",name:"street"})])])}var Te=w(Ae,[["render",Pe],["__scopeId","data-v-29a4da50"]]);const Ee=g({components:{AddressForm:Te},methods:{onSend(){console.log("send",W(this))}}});function Me(t,e,n,s,r,o){const i=C("AddressForm");return f(),h("form",null,[m(i,{name:"fromAddr",legend:"Send From"}),m(i,{name:"toAddr",legend:"Send To"}),l("button",{type:"submit",onClick:e[0]||(e[0]=pe((...c)=>t.onSend&&t.onSend(...c),["prevent"]))},"Send")])}var Ve=w(Ee,[["render",Me],["__scopeId","data-v-22008459"]]);const Ie=g({setup(t){return(e,n)=>(f(),he(Ve))}}),X=me(Ie);X.use(ke);X.mount("#app");
