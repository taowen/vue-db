var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var R=(t,e,s)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,y=(t,e)=>{for(var s in e||(e={}))se.call(e,s)&&R(t,s,e[s]);if(P)for(var s of P(e))re.call(e,s)&&R(t,s,e[s]);return t},T=(t,e)=>ee(t,te(e));var a=(t,e,s)=>(R(t,typeof e!="symbol"?e+"":e,s),s);import{i as N,h as ne,t as S,a as oe,r as L,g as A,e as M,K as ie,c as ae,n as ue,b as w,o as ce,d as _,f as m,j as l,k as $,w as V,v as le,F as C,l as p,m as de,p as fe,q as v,s as F,u as pe,x as he,y as me}from"./vendor.b524b93f.js";const ye=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};ye();const c={rpcProvider(){throw new Error("must install with rpcProvider before query or call")}},j=new Map;function ve(t,e){b.provide(t),Object.assign(c,e),t.mixin({created(){if(c.dehydrate||c.hydrate){const n=this.$.render;this.$.render=function(...o){let i=n.apply(this,o);if((!N(i)||typeof i.type!="string")&&(i=ne("div",i)),c.hydrate)return i;i.props||(i.props={});const u={},h={};for(const[k,f]of Object.entries(S(this.$.data)))oe(f)&&f.value&&f.value.data&&((f.value.stale?h:u)[k]=f.value.data);return i.props["data-dehydrated"]=JSON.stringify(u),i.props["data-stale"]=JSON.stringify(h),i}}const s=this.$.type;let r=s.instanceCount;r||(r=s.instanceCount=L(0)),r.value++},beforeMount(){var o,i;if(!c.hydrate)return;const s=S(this.$.data),r=JSON.parse(((o=this.$el.dataset)==null?void 0:o.dehydrated)||"{}"),n=JSON.parse(((i=this.$el.dataset)==null?void 0:i.stale)||"{}");for(const u of Object.keys(n))s[u].value._query&&s[u].value._query.refresh();for(const[u,h]of Object.entries(y(y({},r),n)))s[u].value={loading:!1,data:h}},async serverPrefetch(){await b.inject().flushing}})}function ge(t,e){M(()=>{const s=e();for(const[r,n]of Object.entries(s))if(typeof n=="object")for(const[o,i]of Object.entries(n))t[r][o]=i;else t[r]=n})}function be(t){return B(t.$).proxy}function B(t){return!t.parent||t.parent.type===ie?t:B(t.parent)}function I(t,e){if(t instanceof d){const s=G(t,e);return ae(()=>{const r=s.value;return{loading:r.loading,data:r.data[0],error:r.error}})}return J(t,e)[0]}function J(t,e){if(t instanceof d)return G(t,e);const s=t;s.instanceCount||(s.instanceCount=L(0)),s.instanceCount.value;const r=[];let n;if(e.$parent)n=e.$parent.$.subTree;else if(e.$root)n=e.$root.$.subTree,delete e.$root;else throw new Error("must provide $parent or $root");return O(r,n,s,e),r}function O(t,e,s,r){if(!!e){if(e.component)e.type===s&&_e(e.component.proxy,r)&&t.push(e.component.proxy),O(t,e.component.subTree,s,r);else if(Array.isArray(e.children))for(const n of e.children)N(n)&&O(t,n,s,r)}}function _e(t,e){if(!e)return!0;for(const[s,r]of Object.entries(e))if(s==="$parent"){if(t.$.parent.proxy!==r)return!1}else if(t[s]!==r)return!1;return!0}function D(t,e,...s){const r=t.$;Q(!0,e,s,r)}function K(t,e,s){if(s.component)Q(!1,t,e,s.component);else if(Array.isArray(s.children))for(const r of s.children)N(r)&&K(t,e,r)}function Q(t,e,s,r){const n=r.proxy;!t&&n[e]?n[e].apply(n,s):K(e,s,r.subTree)}function U(){return new Promise(t=>{ue(t)})}async function x(t){return new Promise(e=>setTimeout(e,t))}function we(t,e){if(e instanceof d)return t;if(t.$.type!==e)throw new Error("type mismatch");return t}function z(t){let e=this&&this.Resource!==d?this:void 0;return{as(s){const r=n=>{const o=[];for(const h of t.affectedTables){const k=j.get(h);for(const f of k||[])o.push(f.newRequest())}const i=t.command||s,u=new W(i,n);return c.rpcProvider(o,u),u.promise};return T(y({},e),{[s]:r,defineCommand:z})}}}function $e(t,e){return w(new d(t,e))}const g=class{constructor(){a(this,"buffered",[]);a(this,"flushing")}static provide(e){e.provide(g.key,new g)}static inject(){return A().appContext.provides[g.key]}execute(e){this.buffered.push(e),this.buffered.length===1&&(this.flushing=this.flush())}async flush(){await U();const e=this.buffered;this.buffered=[],await c.rpcProvider(e);for(const s of e)await s.showingLoading;this.flushing=void 0}};let b=g;a(b,"key",Symbol());class qe{constructor(e,s){a(this,"result",L({loading:!1,data:[],error:void 0,_query:this}));a(this,"criteria",{});a(this,"version",0);a(this,"queryBuffer");this.resource=e,this.queryBuffer=b.inject();const r=A();M(()=>{s&&(this.criteria=s()),c.hydrate&&!r.isMounted||this.queryBuffer.execute(this.newRequest(!r.isMounted))})}newRequest(e){return this.version++,new H(this,!!e)}refresh(){this.queryBuffer.execute(this.newRequest())}}class d{constructor(e,s){a(this,"pickedFields");a(this,"subResources",{});this.table=e,this.options=s}clone(){const e=new d(this.table,this.options);return e.pickedFields=this.pickedFields,e.subResources=y({},this.subResources),e}pick(...e){const s=this.clone();return s.pickedFields=e,w(s)}load(e,s,r,n){const o=this.clone();return o.subResources[e]={single:!0,resource:s,dynamicCriteria:r,staticCriteria:n==null?void 0:n.staticCriteria},w(o)}query(e,s,r,n){const o=this.clone();return o.subResources[e]={resource:s,dynamicCriteria:r,staticCriteria:n==null?void 0:n.staticCriteria},w(o)}toJSON(){var e;return{table:this.table,staticCriteria:(e=this.options)==null?void 0:e.staticCriteria,subResources:Object.keys(this.subResources).length===0?void 0:this.subResources}}}function G(t,e){const s=new qe(S(t),e);return A().scope.run(()=>{let r=j.get(t.table);r||j.set(t.table,r=new Set),r.add(s),ce(()=>{r.delete(s)})}),s.result}class H{constructor(e,s){a(this,"baseVersion");a(this,"criteria");a(this,"showingLoading");this.query=e,this.showLoading=s,this.baseVersion=e.version,this.criteria=e.criteria,s&&(c.loadingPreDelay?x(c.loadingPreDelay||0).then(()=>{this.showingLoading=this.loadingCountdown()}):this.showingLoading=this.loadingCountdown())}async loadingCountdown(){this.isExpired||(this.query.result.value={loading:!0,data:[],error:void 0},await x(c.loadingPostDelay||0))}get resource(){return this.query.resource}get isExpired(){return this.baseVersion!==this.query.version}resolve(e,s){if(!this.isExpired){if(this.showingLoading){this.showingLoading.then(()=>{this.showingLoading=void 0,this.resolve(e,s)});return}this.query.version++,this.query.result.value={loading:!1,data:e,error:void 0,stale:s}}}reject(e){if(!this.isExpired){if(this.showingLoading){this.showingLoading.then(()=>{this.showingLoading=void 0,this.reject(e)});return}this.query.version++,this.query.result.value={loading:!1,data:[],error:e}}}toJSON(){return{resource:this.resource,criteria:this.criteria}}}class W{constructor(e,s){a(this,"promise");a(this,"resolve");a(this,"reject");a(this,"responded",!1);this.command=e,this.args=s,this.promise=new Promise((r,n)=>{this.resolve=o=>{this.responded||(this.responded=!0,r(o))},this.reject=o=>{this.responded||(this.responded=!0,n(o))}})}toJSON(){return{command:this.command,args:this.args}}}var ke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",install:ve,animate:ge,pageOf:be,load:I,query:J,walk:D,waitNextTick:U,sleep:x,castTo:we,defineCommand:z,defineResource:$e,Resource:d,QueryRequest:H,CommandRequest:W});function X(t){const e={};return D(t,"fillForm",e),e}var q=(t,e)=>{const s=t.__vccOpts||t;for(const[r,n]of e)s[r]=n;return s};const Re=_({props:{label:{default:""},name:{type:String,required:!0}},data(){return{value:""}},methods:{fillForm(t){t[this.name]=this.value}}}),Se=["name"];function Ce(t,e,s,r,n,o){return p(),m(C,null,[l("label",null,$(t.label),1),V(l("input",{type:"textbox",name:t.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i)},null,8,Se),[[le,t.value]])],64)}var Fe=q(Re,[["render",Ce]]);const je=_({props:{label:{default:""},name:{required:!0,type:String},options:{default:[]}},data(){return{selected:""}},methods:{fillForm(t){t[this.name]=this.selected}}}),Oe=l("option",{value:""},"Please select...",-1),xe=["value"];function Ne(t,e,s,r,n,o){return p(),m(C,null,[l("label",null,$(t.label),1),V(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.selected=i)},[Oe,(p(!0),m(C,null,fe(t.options,i=>(p(),m("option",{value:i.id},$(i.name),9,xe))),256))],512),[[de,t.selected]])],64)}var E=q(je,[["render",Ne]]);const Le=_({components:{SelectField:E,InputField:Fe},props:{name:{required:!0,type:String},legend:{default:"Address"}},data(){return{provinces:[{id:"jiangxi",name:"jiangxi"},{id:"hubei",name:"hubei"}]}},computed:{cities(){var s;const t=(s=I(E,{$parent:this,name:"province"}))==null?void 0:s.selected;return{jiangxi:[{id:"nanchang",name:"nanchange"},{id:"jiujiang",name:"jiujiang"}],hubei:[{id:"wuhan",name:"wuhan"},{id:"huangshi",name:"huangshi"}]}[t]||[]}},methods:{fillForm(t){t[this.name]=X(this)}}}),Ae={class:"fields"};function Pe(t,e,s,r,n,o){const i=F("SelectField"),u=F("InputField");return p(),m("fieldset",null,[l("legend",null,$(t.legend),1),l("div",Ae,[v(i,{label:"province:",name:"province",options:t.provinces},null,8,["options"]),v(i,{label:"city:",name:"city",options:t.cities},null,8,["options"]),v(u,{label:"street:",name:"street"})])])}var Te=q(Le,[["render",Pe],["__scopeId","data-v-29a4da50"]]);const Ee=_({components:{AddressForm:Te},methods:{onSend(){console.log("send",X(this))}}});function Me(t,e,s,r,n,o){const i=F("AddressForm");return p(),m("form",null,[v(i,{name:"fromAddr",legend:"Send From"}),v(i,{name:"toAddr",legend:"Send To"}),l("button",{type:"submit",onClick:e[0]||(e[0]=pe((...u)=>t.onSend&&t.onSend(...u),["prevent"]))},"Send")])}var Ve=q(Ee,[["render",Me],["__scopeId","data-v-22008459"]]);const Be=_({setup(t){return(e,s)=>(p(),he(Ve))}}),Y=me(Be);Y.use(ke);Y.mount("#app");
