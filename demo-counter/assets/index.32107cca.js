var Y=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var w=(t,e,r)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,k=(t,e)=>{for(var r in e||(e={}))te.call(e,r)&&w(t,r,e[r]);if(B)for(var r of B(e))re.call(e,r)&&w(t,r,e[r]);return t},E=(t,e)=>Z(t,ee(e));var c=(t,e,r)=>(w(t,typeof e!="symbol"?e+"":e,r),r);import{d as _,c as x,o as d,i as O,h as se,t as C,a as ne,r as j,g as N,e as F,K as J,b as oe,n as ie,f as m,j as ce,k as ue,l as L,m as ae,p as f,w as v,q as M,s as g,u as le,T as fe,v as de,x as pe,y as he}from"./vendor.8bc3a274.js";const ye=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}};ye();var b=(t,e)=>{const r=t.__vccOpts||t;for(const[s,n]of e)r[s]=n;return r};const me=_({data(){return{count:1}},methods:{increase(){this.count+=1}}}),ve=["value"];function _e(t,e,r,s,n,o){return d(),x("input",{type:"textbox",value:t.count},null,8,ve)}var T=b(me,[["render",_e]]);const u={rpcProvider(){throw new Error("must install with rpcProvider before query or call")}},R=new Map;function be(t,e){y.provide(t),Object.assign(u,e),t.mixin({created(){if(u.dehydrate||u.hydrate){const n=this.$.render;this.$.render=function(...o){let i=n.apply(this,o);if((!O(i)||typeof i.type!="string")&&(i=se("div",i)),u.hydrate)return i;i.props||(i.props={});const p={};for(const[$,l]of Object.entries(C(this.$.data)))ne(l)&&l.value&&l.value.data&&(p[$]=l.value.data);return i.props["data-dehydrated"]=JSON.stringify(p),i}}const r=this.$.type;let s=r.instanceCount;s||(s=r.instanceCount=j(0)),s.value++},beforeMount(){var n;if(!u.hydrate)return;const r=(n=this.$el.dataset)==null?void 0:n.dehydrated;if(!r)return;const s=C(this.$.data);for(const[o,i]of Object.entries(JSON.parse(r)))s[o].value={loading:!1,data:i}},async serverPrefetch(){await y.inject().flushing}})}function $e(t,e){F(()=>{const r=e();for(const[s,n]of Object.entries(r))if(typeof n=="object")for(const[o,i]of Object.entries(n))t[s][o]=i;else t[s]=n})}function S(t){return D(t.$).proxy}function D(t){return!t.parent||t.parent.type===J?t:D(t.parent)}function P(t,e){if(t instanceof a){const r=z(t,e);return oe(()=>{const s=r.value;return{loading:s.loading,data:s.data[0],error:s.error}})}return K(t,e)[0]}function K(t,e){if(t instanceof a)return z(t,e);const r=t;r.instanceCount||(r.instanceCount=j(0)),r.instanceCount.value;const s=[];let n;if(e.$parent)n=e.$parent.$.subTree;else if(e.$root)n=e.$root.$.subTree,delete e.$root;else throw new Error("must provide $parent or $root");return q(s,n,r,e),s}function q(t,e,r,s){if(!!e){if(e.component)e.type===r&&we(e.component.proxy,s)&&t.push(e.component.proxy),q(t,e.component.subTree,r,s);else if(Array.isArray(e.children))for(const n of e.children)O(n)&&q(t,n,r,s)}}function we(t,e){if(!e)return!0;for(const[r,s]of Object.entries(e))if(r==="$parent"){if(t.$.parent.proxy!==s)return!1}else if(t[r]!==s)return!1;return!0}function ke(t,e,...r){const s=t.$;G(!0,e,r,s)}function Q(t,e,r){if(r.component)G(!1,t,e,r.component);else if(Array.isArray(r.children))for(const s of r.children)O(s)&&Q(t,e,s)}function G(t,e,r,s){const n=s.proxy;!t&&n[e]?n[e].apply(n,r):Q(e,r,s.subTree)}function H(){return new Promise(t=>{ie(t)})}async function ge(t){return new Promise(e=>setTimeout(e,t))}function Ce(t,e){if(e instanceof a)return t;if(t.$.type!==e)throw new Error("type mismatch");return t}function I(t){let e=this&&this.Resource!==a?this:void 0;return{as(r){const s=n=>{const o=[];for(const $ of t.affectedTables){const l=R.get($);for(const X of l||[])o.push(X.newRequest())}const i=t.command||r,p=new U(i,n);return u.rpcProvider(o,p),p.promise};return E(k({},e),{[r]:s,defineCommand:I})}}}function Re(t,e){return m(new a(t,e))}const h=class{constructor(){c(this,"buffered",[]);c(this,"flushing")}static provide(e){e.provide(h.key,new h)}static inject(){return N().appContext.provides[h.key]}execute(e){this.buffered.push(e),this.buffered.length===1&&(this.flushing=this.flush())}async flush(){await H();const e=this.buffered.map(r=>r.newRequest());this.buffered=[],await u.rpcProvider(e),this.flushing=void 0}};let y=h;c(y,"key",Symbol());class qe{constructor(e,r){c(this,"result",j({loading:!1,data:[],error:void 0}));c(this,"criteria",{});c(this,"version",0);this.resource=e;const s=y.inject(),n=N();F(()=>{r&&(this.criteria=r()),u.hydrate&&!n.isMounted||s.execute(this)})}newRequest(){return this.version++,new W(this)}}class a{constructor(e,r){c(this,"pickedFields");c(this,"subResources",{});this.table=e,this.options=r}clone(){const e=new a(this.table,this.options);return e.pickedFields=this.pickedFields,e.subResources=k({},this.subResources),e}pick(...e){const r=this.clone();return r.pickedFields=e,m(r)}load(e,r,s,n){const o=this.clone();return o.subResources[e]={single:!0,resource:r,dynamicCriteria:s,staticCriteria:n==null?void 0:n.staticCriteria},m(o)}query(e,r,s,n){const o=this.clone();return o.subResources[e]={resource:r,dynamicCriteria:s,staticCriteria:n==null?void 0:n.staticCriteria},m(o)}toJSON(){var e;return{table:this.table,staticCriteria:(e=this.options)==null?void 0:e.staticCriteria,subResources:Object.keys(this.subResources).length===0?void 0:this.subResources}}}function z(t,e){const r=new qe(C(t),e);return N().scope.run(()=>{let s=R.get(t.table);s||R.set(t.table,s=new Set),s.add(r),ce(()=>{s.delete(r)})}),r.result}class W{constructor(e){c(this,"baseVersion");c(this,"criteria");this.query=e,this.baseVersion=e.version,this.criteria=e.criteria}get resource(){return this.query.resource}get isExpired(){return this.baseVersion!==this.query.version}resolve(e){this.isExpired||(this.query.version++,this.query.result.value={loading:!1,data:e,error:void 0})}reject(e){this.isExpired||(this.query.version++,this.query.result.value={loading:!1,data:[],error:e})}toJSON(){return{resource:this.resource,criteria:this.criteria}}}class U{constructor(e,r){c(this,"promise");c(this,"resolve");c(this,"reject");c(this,"responded",!1);this.command=e,this.args=r,this.promise=new Promise((s,n)=>{this.resolve=o=>{this.responded||(this.responded=!0,s(o))},this.reject=o=>{this.responded||(this.responded=!0,n(o))}})}toJSON(){return{command:this.command,args:this.args}}}var xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",install:be,animate:$e,pageOf:S,load:P,query:K,walk:ke,waitNextTick:H,sleep:ge,castTo:Ce,defineCommand:I,defineResource:Re,Resource:a,QueryRequest:W,CommandRequest:U});const Oe=_({methods:{onClicked(){var t;(t=P(T,{$root:S(this)}))==null||t.increase()}}});function je(t,e,r,s,n,o){return d(),x("button",{onClick:e[0]||(e[0]=(...i)=>t.onClicked&&t.onClicked(...i))},"+")}var Ne=b(Oe,[["render",je]]);const Te=_({computed:{displayBack(){var e;return(((e=P(T,{$root:S(this)}))==null?void 0:e.count)||0)+20}}});function Se(t,e,r,s,n,o){return" current is: "+ue(t.displayBack)}var Pe=b(Te,[["render",Se]]);const Ae={style:{display:"flex","flex-direction":"row","column-gap":"8px"}},Be=M("Go to Counter1"),Ee=M("Go to Counter2"),V=_({setup(t){return(e,r)=>{const s=L("router-link");return d(),x("div",null,[ae("p",Ae,[f(s,{to:"/"},{default:v(()=>[Be]),_:1}),f(s,{to:"/counter2"},{default:v(()=>[Ee]),_:1})]),f(Pe),f(T),f(Ne)])}}});const Ve={};function Fe(t,e){const r=L("router-view");return d(),g(r,null,{default:v(({Component:s,route:n})=>[f(fe,{name:"fade"},{default:v(()=>[(d(),g(J,null,[(d(),g(le(s),{key:n.path}))],1024))]),_:2},1024)]),_:1})}var Je=b(Ve,[["render",Fe]]);const Le=[{path:"/",component:V},{path:"/counter2",component:V}],Me=de({history:pe(),routes:Le}),A=he(Je);A.use(Me);A.use(xe);A.mount("#app");
